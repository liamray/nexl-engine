<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>nexl-client</title>

    <link rel="stylesheet" type="text/css" href="css/style.css"/>
    <link rel="stylesheet" type="text/css" href="components/tabs/tabs.css"/>
    <link rel="stylesheet" type="text/css" href="css/toolbar.css"/>
    <link rel="stylesheet" type="text/css" href="components/file-dialog/file-dialog.css"/>
    <link rel="stylesheet" type="text/css" href="components/key-value-editor/key-value-editor.css"/>
    <link rel="stylesheet" type="text/css" href="jquery/jquery-ui/jquery-ui.css"/>
    <link rel="stylesheet" type="text/css" href="components/jquery-autocomplete/jquery-autocomplete.css"/>
    <link rel="stylesheet" type="text/css" href="components/jstree/themes/default/style.min.css"/>

    <script type="text/javascript" src="jquery/jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="jquery/jquery-ui/jquery-ui.js"></script>

    <script type="text/javascript" src="util-functions/extended-js-api.js"></script>
    <script type="text/javascript" src="util-functions/utils.js"></script>
    <script type="text/javascript" src="util-functions/nexl-ui.js"></script>
    <script type="text/javascript" src="util-functions/add-action.js"></script>

    <script type="text/javascript" src="components/tabs/tabs.js"></script>
    <script type="text/javascript" src="components/file-dialog/file-dialog.js"></script>
    <script type="text/javascript" src="components/key-value-editor/key-value-editor.js"></script>
    <script type="text/javascript" src="components/jquery-autocomplete/jquery-autocomplete.js"></script>
    <script type="text/javascript" src="components/jquery-resizable/jquery-e-resizable.js"></script>
    <script type="text/javascript" src="components/ace/ace.js" charset="utf-8"></script>
    <script type="text/javascript" src="components/jstree/jstree.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="components/dir-browser/dir-browser.js" charset="utf-8"></script>

    <script type="text/javascript">
        $(function () {
            module.nexlui.init();
        });
    </script>
</head>
<body>

<!-- ------------------------------------------------------------------------------------------------ -->
<!-- buttons panel -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div id="buttons-panel">
    <div class="new-file-button" title="New nexl source file"></div>
    <div class="open-file-button" title="Open existing nexl source file (Ctrl+O)"></div>

    <div class="save-file-button" title="Save nexl source file  (Ctrl+S)" title-baw=""></div>
    <div class="save-file-as-button" title="Save nexl source file as" title-baw=""></div>

    <span class="separator-button"></span>

    <div class="new-remote-button" title="New remote nexl source"></div>
    <span class="separator-button"></span>

    <div class="eval-button" title="Evaluate nexl expression (F9)"></div>

    <span class="separator-button"></span>

    <div class="about-button" title="About nexl-client"></div>
</div>

<!-- ------------------------------------------------------------------------------------------------ -->
<!-- tabs container -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div id="tabs">
    <ul>
    </ul>
</div>


<!-- ------------------------------------------------------------------------------------------------ -->
<!-- external args + output area -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div id="output-area">
    <div id="args">
        <div class="frame">
            <div>External arguments</div>
            <span id="addExternalArg" title="Add key-value pair"></span>
        </div>
        <div id="external-arguments-editor" class="key-value-editor"></div>
    </div>

    <div id="output">
        <div class="frame">
            <div>Output</div>
        </div>
        <textarea readonly></textarea>
    </div>
</div>


<!-- ------------------------------------------------------------------------------------------------ -->
<!-- container for file-dialog, jquery loads it from the template -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div id="file-dialog-container"></div>


<!-- ------------------------------------------------------------------------------------------------ -->
<!-- popup messages container, confirm message container -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div id="popup-message"></div>

<div id="dialog-confirm">
    <p></p>
</div>


<!-- ------------------------------------------------------------------------------------------------ -->
<!-- explore nexl source dialog -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div id="explore-nexl-sources-container">
    <div class="explore-nexl-sources" style="width:100%; height:100%;"></div>
</div>


<!-- ------------------------------------------------------------------------------------------------ -->
<!-- dir browser -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div id="dir-browser-dialog" style="display: none;">
    <div id="dir-browser" style="width:100%; height:100%; overflow-y: auto;"></div>
</div>

<!-- ------------------------------------------------------------------------------------------------ -->
<!-- run server dialog -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div class="run-server-dialog" style="display: none;" title="Run nexl server on this computer">
    <div>
        <label title="Empty dir = ~/nexl-sources">nexl sources directory</label><input type="text" class="dir"><span
            class="browse"></span>
    </div>

    <div>
        <label title="Empty port = use default port">nexl server port</label><input type="text" class="port">
    </div>

    <div>
        <label title="To install nexl server manually write the following in the command line <br/><h4>npm i nexl-server -g</h4>">Do
            not install nexl server</label><input type="checkbox" class="dont-install">
    </div>
</div>

<!-- ------------------------------------------------------------------------------------------------ -->
<!-- choose expression dialog -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div class="choose-expression-dialog" style="display: none;" title="Expression builder">
    <div class="expressions-list-container">
        <label>Available variables</label>
        <div>
            <ul>
            </ul>
        </div>
    </div>

    <div class="expression-fitting">
        <label>nexl expression</label>
        <div class="nexl-expression">${}</div>
        <input type="button" value="Add action" class="add-action-button"/>
        <input type="button" value="Reset actions" class="reset-events-button"/>
    </div>
</div>

<!-- ------------------------------------------------------------------------------------------------ -->
<!-- actions builder dialog -->
<!-- ------------------------------------------------------------------------------------------------ -->
<div id="addActionDialog" style="display: none;" title="Add action">
    <div class="actionsContainer">
        <div>
            <label>Action ID</label>
            <select class="actionIds">
                <option disabled selected value></option>
                <option title="Object property resolution"
                        example="the ${obj.%s} expression resolves %s property from obj1 object">.
                </option>
                <option title="Access array index or substring"
                        example="the ${item[ %s ]} expression accesses array indexes ( in case of array ) or extracts characters by indexes ( in case of string )<br/>Indexes must be one of the following : ^ ( first item ), $ ( last item ) or integer ( including negative numbers ). Multiple ranges are also available">
                    []
                </option>
                <option title="Function call"
                        example="the ${func( %s )} expression call a func function with %s arguments. Arguments must be nexl expression(s) separated with comma">
                    ()
                </option>
                <option title=" Default value"
                        example="the ${item@%s} expression is evaluating to %s default value if the item is undefined">@
                </option>
                <option ref=".typeCast" title="Typecast">:</option>
                <option ref=".objectOperations" title="Object operations">~</option>
                <option title="Object key reverse resolution"
                        example="the ${obj1<%s} expression performs key resolution in obj1 object by %s value">
                    &lt;</option>
                <option ref=".arrayOperations" title="Array operations">#</option>
                <option title="Join array elements" example="the ${arr&%s} expression joins all array elements with %s">
                    &
                </option>
                <option ref=".stringOperations" title="String operations">^</option>
                <option title="Eliminate items from array or object"
                        example="the ${item-%s} expression eliminates a %s item from objOrArray">-
                </option>
                <option title="Add items to array or merge objects"
                        example="in the ${item+%s} expression adds a %s to the end of array or merges a %s object to item object">
                    +
                </option>
                <option title="Mandatory value validator"
                        example="the ${test*%s} expression will throw error with %s error message if the test item is undefined">
                    *
                </option>
                <option ref=".undefinedValueOperations" title="Undefined value operations">!</option>
                <option title="Pushes current chain value to function parameters stack"
                        example="See documentation for more information">?
                </option>
            </select>
        </div>


        <div class="customValue">
            <label title="Action ID can be a constant value or nexl expression">Action Value</label>
            <input type="text" title="Start typing action value. Action ID can be a constant value or nexl expression"/>
        </div>

        <div class="typeCast">
            <label>Action Value</label>
            <select>
                <option disabled selected value></option>
                <option title="Casts a primitive to numeric"
                        example="the ${item%s} expression expression casts item's value to numeric">num
                </option>
                <option title="Casts a primitive to string"
                        example="the ${item%s} expression expression casts item's value to string">str
                </option>
                <option title="Casts a primitive to boolean"
                        example="the ${item%s} expression expression casts item's value to boolean">bool
                </option>
                <option title="Converts to null" example="the ${item%s} expression converts item's value to null">null
                </option>
                <option title="Converts to undefined"
                        example="the ${item%s} expression converts item's value to undefined">
                    undefined
                </option>
            </select>
        </div>

        <div class="objectOperations">
            <label>Action Value</label>
            <select>
                <option disabled selected value></option>
                <option title="Resolves object keys" example="the ${obj~K} expression resolves a key set of obj object">
                    K
                </option>
                <option title="Resolves object values"
                        example="the ${obj~V} expression resolves all values of obj object">
                    V
                </option>
                <option title="Converts to object" example="the ${item~O} converts an item to object">O</option>
                <option title="Produces XML from object"
                        example="the ${obj~X} expression produces a XML from obj object">X
                </option>
                <option title="Produces YAML from object"
                        example="the ${obj~Y} expression produces a YAML from obj object">
                    Y
                </option>
                <option title="Produces key-value paris from object"
                        example="the ${obj~P} expression produces a key-value pairs ( property file) from obj object">P
                </option>
            </select>
        </div>

        <div class="arrayOperations">
            <label>Action Value</label>
            <select>
                <option disabled selected value></option>
                <option title="Sorts array ascending"
                        example="the ${arr#S} expression sorts arr array in ascending order">
                    S
                </option>
                <option title="Sorts array descending"
                        example="the ${arr#s} expression sorts arr array in descending order">
                    s
                </option>
                <option title="Unique value only"
                        example="the ${arr#U} expression makes arr array elements unique ( omitting duplicates )">U
                </option>
                <option title="Duplicate values only"
                        example="the ${arr#D} expression leaves only duplicate items in arr array">D
                </option>
                <option title="Calculates array length"
                        example="the ${arr#LEN} expression calculates length of arr array">
                    LEN
                </option>
                <option title="Converts to array" example="the ${item#A} expression converts an item to array">A
                </option>
                <option title="Gets first array item or undefined"
                        example="the ${arr#F} resolves the first array element if array has only one element. Otherwise this expression is evaluated to undefined">
                    F
                </option>
            </select>
        </div>

        <div class="stringOperations">
            <label>Action Value</label>
            <select>
                <option disabled selected value></option>
                <option title="Makse uppercase" example="the ${str^U} expression makes a str string uppercase">U
                </option>
                <option title="Capitalizes first letter"
                        example="the ${str^U1} expression capitalizes a first letter of str string">U1
                </option>
                <option title="Makes lowercase" example="the ${str^L} expression makes a str string lower">L</option>
                <option title="Calculates string length"
                        example="the ${str^LEN} expression calculates length of str string">
                    LEN
                </option>
                <option title="Trims a string" example="the ${str^T} expression trims a str string">T</option>
            </select>
        </div>

        <div class="undefinedValueOperations">
            <label>Action Value</label>
            <select>
                <option disabled selected value></option>
                <option title="Convert empty string, array or object to undefined"
                        example="the ${item!E} expression converts item to undefined if this item is empty string, empty array or empty object">
                    E
                </option>
                <option title="Evaluates expression as undefined"
                        example="the ${expr!U} expression is evaluated to undefined if it points to sub expression and one of them is evaluated to undefined">
                    U
                </option>
            </select>
        </div>

        <div class="exampleBox"></div>
    </div>
</div>

<div style="display: none;" id="scratch1">
    /*
    nexl source example
    See expressions examples below. Put each expression into "Expression" field to test and click "Evaluate nexl
    expression" ( F9 )

    More documentation is here http://www.nexl-js.com
    GitHub project https://github.com/yevgeny-sergeyev/nexl-js
    */

    distanceToMoon = 384400;

    fruits = ['Mango', 'Banana', 'Orange', 'Annona', 'Grape'];

    person = {
    name: 'Alex',
    age: 25,
    country: 'Canada'
    };

    /*
    Expressions examples

    ${person.name}
    First resolves person object and then resolves a name property of that object

    ${fruits#S}
    Sort fruits array

    ${fruits#S&,}
    Sorts fruits array and then joins all elements with comma

    ${fruits#S&\n}
    Sorts fruits array and then joins all elements with LF

    ${fruits[-1]}
    Resolves a second array element from the end

    ${person~K}
    Resolves a key set of person object as array

    ${person~V&,}
    Resolves all values of person object as array and then joins all array elements with comma

    ${person~K#s[$]}
    Resolves a key set of person object as array, sorts them in descending order, resolves last array element

    ${person.country[3..$]^U1}
    Resolves a country property of person object, substrings it from fourth element to the end and then capitalizes a
    first letter

    ${person~X}
    ${person~Y}
    ${person~P}
    Produces an XML, YAML and key-value pairs ( property file ) from person object

    ${person&lt;Alex}
    Resolves a key name of person object by ‘Alex’ value ( i.e. makes object property reverse resolution )

    ${person&lt;Alex[0]}
    Resolves a key name of person object by ‘Alex’ value as array and then resolves first array element

    ${person~K+${person~V}&,}
    Joins two arrays. The first array is a key set of person object, the second array are values of person object.
    Finally joins all array elements with comma

    ${distanceToMoon~O}
    Converts a distanceToMoon primitive number to JavaScript object

    ${distanceToMoon~O+${person}}
    Converts a distanceToMoon primitive number to JavaScript object and then merges to him a person object

    */
</div>

</body>
</html>